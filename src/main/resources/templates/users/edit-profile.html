<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:insert="partials/header">
    <meta charset="UTF-8">
    <title>Edit Profile</title>
</head>
<body>
<nav th:insert="partials/navbar"></nav>
<div class="card">
    <h1 class="card-header text-center">Edit My Profile</h1>
    <div class="card-body">
        <form class="d-flex flex-column align-items-center" th:action="@{/profile/edit}" method="POST">
            <div class="d-flex justify-content-around flex-column">
                <div>
                    <label for="username">Username</label>
                    <input id="username" name="username" th:value="${user.getUsername()}"/>
                </div>
                <div>
                    <label for="username">First Name</label>
                    <input id="firstname" name="firstname" th:value="${user.getFirstName()}"/>
                </div>
                <div>
                    <label for="lastname">Last Name</label>
                    <input id="lastname" name="lastname" th:value="${user.getLastName()}" />
                </div>
                <div class="mx-3">
                    <label for="email">Email</label>
                    <input id="email" name="email" th:value="${user.getEmail()}" />
                </div>
                <div>
                    <p>Password: <span><a th:href="@{/profile/password}"> Change Password</a></span></p>
                </div>


                <div>
                    <p>Image: <span><a th:href="@{/image}"> Change Image</a></span></p>
                </div>
                <div>
                    <button class="upload">Upload file</button>
                </div>
                <div>
                    <img th:src="${user.getImage()}" width="200" height="200" class="logo" />
                </div>


            </div>
            <input class="mt-3" value="Save Changes" type="submit" />
        </form>
    </div>
</div>

</body>
<script src="//static.filestackapi.com/filestack-js/3.x.x/filestack.min.js"></script>
<script>

    const button = document.querySelector('.upload')
    const image = document.querySelector('.logo')
    button.addEventListener('click', () => {
        const apiKey = 'A87r7oKaT6i0PJ9UGEci7z'
        const client = filestack.init(apiKey);
        const options = {
            onUploadDone: (uploadResponse) => {
                console.log('onUploadDone', uploadResponse)
                image.setAttribute('src', uploadResponse.filesUploaded[0].url)
            }
        };
        client.picker(options).open()
    })

</script>
</html>